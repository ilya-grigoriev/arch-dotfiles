#!/bin/bash

duck() {
	url="https://lite.duckduckgo.com/lite?&q="$*""
	lynx -trace "$url"
}

wiki() {
	url=$(echo "https://wikipedia.org/wiki/$*" | tr ' ' '_')
	curl -L $url | html2text --ignore-images --ignore-links | less
}

wiki_ru() {
	url=$(echo "https://ru.wikipedia.org/wiki/$*" | tr ' ' '_')
	curl -L $url | html2text --ignore-images --ignore-links | less
}

alias gpt_setup="pipx install g4f[all]"
gpt_run() {
	nohup g4f gui &
	sleep 1
	nohup g4f api &
	sleep 1
	nohup firefox http://localhost:8080/chat &
	sleep 1
	exit
}
alias gpt_stop="pkill g4f"

myman() {
	number_section=$1
	name_page=$2
	curl -s "https://www.man7.org/linux/man-pages/man$number_section/$name_page.$number_section.html" | html2text | awk 'NR>12 {print $0}' | head -n -22 | mdless
}

not() {
	notes_dirpath="$HOME/dev/un"
	note_filepath="$notes_dirpath/$(cd ~/dev/un; fzf)"
	(cd $notes_dirpath; vim $note_filepath)
}

yrl() {
	yay -R $(yay -Q | cut -d ' ' -f 1 | fzf)
}

dpi() {
	ciadpi --tls-sni "www.google.com" -f-2 -r23+s --ip-opt --no-ipv6 &
	disown
}

function ap() {
	apropos $1 | less
}

function vm_run() {
	sudo systemctl enable libvirtd
	sudo systemctl start libvirtd
	sleep 1
	nohup virt-manager &
	exit
}
function vm_stop() {
	sudo systemctl disable libvirtd.service
	sudo systemctl stop libvirtd.service
	for i in $(ip a | awk '/virbr.:/ {print substr($2, 0, length($2)-1)}'); do
		sudo ip link delete $i
	done
}

function sss() {
	package_name=$1
	if [ "$package_name" ]; then
		selected_package_name=$(sudo pacman -Ss $package_name | awk '{if (NR % 2 != 0) print $0}' | fzf)
		if [ "$selected_package_name" ]; then
			formatted_package_name=$(echo $selected_package_name | cut -d ' ' -f 1)
			echo $formatted_package_name
			sudo pacman -S $formatted_package_name
		fi
	fi
}

function fusb() {
	iso=$1
	usb=$2
	sudo dd bs=4M if=$iso of=$usb conv=fsync oflag=direct status=progress
}
